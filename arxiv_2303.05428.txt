0. Abstruct

量子コンピューティングは、効率的なコンピューティングのための新しいパラダイムを提供し、多くのAIアプリケーションがその潜在的な性能向上の恩恵を受ける可能性がある。
しかし、主な制限は線形演算への制約であり、データ中の複雑な関係の表現を妨げている。
本研究では、非線形近似のための量子スプラインの効率的な実装を提案する。
特に、まず、可能なパラメトリックについて議論し、スプライン係数の推定値を得るためにHHLアルゴリズムを利用するための最も便利なパラメトリックを選択する。
次に、MLで採用されている最も一般的な活性化関数の評価ルーチンとしてのQSplineの性能を調査する。
最後に、HHLに代わる古典的な手法との詳細な比較も示す。


1 Introduction

量子コンピューティング（QC）は、量子力学を活用して量子マシンに驚異的な計算能力を持たせることで、情報技術の世界に革命を起こす可能性を秘めた新興分野である。
これにより、古典的なデバイスでは実現不可能な問題を解決できるようになる。
もちろん、こうした前提は、特に人工知能の領域で機械学習やディープラーニングのモデルを採用する場合など、多くの実世界での応用にとって非常に魅力的だ。
しかし、量子状態に対する演算は、量子力学の法則[1]の下で、線形かつユニタリーであることが要求される。
この制限により、これらの手法の主な強みである、複雑な非線形関係を正確に記述する能力が奪われてしまう。

1.1 Background

スプライン関数は、変数間の関係をモデル化するのに適した平滑化手法であり、通常、データ探索の視覚的補助として、または推定目的のために採用される[2]。
基礎となる考え方は、入力特徴量をいわゆる基底展開で補強した線形モデルを使用することである。
これらは元の変数の変換から成り、非線形性を導入する役割を果たす。
技術的には、スプラインはブレイクポイント（ノットとも呼ばれる）で区切られたサブ区間にサンプルデータを分割することで構築される。
そして，固定次数の多項式が各区間にフィットされ，区分多項式回帰になる．
形式的には，1次元入力ベクトルxの場合，ターゲット変数yとの関係は，ノット {ξk}k=1,...,K を持つ次数Mスプラインで表現できる．

式（１)

ここで、θは基底展開に付随する係数のベクトル、nobsはサンプルサイズ、ランダム誤差項、デザイン行列Nは以下のように定義されるM + K基底関数を含む：

式（2)
式（3)

上記の定式化には、各セグメントにフィットされる次数Mの多項式を決定するM個の基底関数が含まれていることに注意してください。
追加のK個の基底は、次数M - 2までのスプラインとその導関数に連続性制約を導入する。
そして、ゴールは、曲率のリッジ正則化が粗さペナルティとして働き、残差平方和（RSS）を最小化する最適なパラメータθのセットを見つけることである：

式（4)

ここでΩは偏二次導関数を含む対角行列である。(4)の解は簡単に次のようになる：

式（５)


1.2 Contribution

この研究では、ニューラルネットワークでよく使われる活性化関数の近似に量子スプラインを採用する方法を示す。
実際には、2つの異なる戦略に従った。ハイブリッドアプローチは、Harrow Hassidim Lloyd (HHL)量子アルゴリズムにより、
スプライン係数の量子推定値を計算する。その後、古典的な装置を使って活性化関数を評価する。
一方、完全量子アプローチでは、HHL推定値を読み込んで関数を評価する回路を追加することで、評価プロセスをエンドツーエンドで行う。
また、HHLアルゴリズムの効率について、古典的アルゴリズムと比較した場合の詳細な議論も行う。


1.3 Related Works

量子ニューラルネットワークを構築する際の大きな問題の1つは、量子システム上で非線形活性化関数を実装することである。
実際、[1]で議論されているように、量子状態に対する演算は量子力学の法則の下で線形かつユニタリーであることが要求される。
この方向で最も有望な試みは[3]に記載されており、著者らは成功するまで繰り返す技術を用いて、非線形活性化関数を再現する量子回路を設計した。
最大の限界は、この関数が0, π 2の範囲の入力を必要とすることであり、これは実世界の問題にとっては厳しい制約である。
しかし、[4]では、領域の制約をなくし、活性化ゲートのパラメータを学習することで、一歩前進した。
量子デバイス上の行列反転に関しては、HHLアルゴリズム[5]が標準的な参考文献です。
実際のアプリケーションでHHLを使用することの限界については、[6]で議論されています。
そのため、HHLを他の量子アルゴリズムのテンプレートとして見るのが最適です。
7]では、著者らが電磁散乱断面積におけるHHLの優位性を研究し、任意に指定された問題に対して指数関数的なスピードアップを達成できる可能性を示しています。


2 Quantum Spline

本研究の最終目標は、量子スプライン（QSpline）による非線形近似を研究することである。
特に、ニューラルネットワークで採用されているいくつかの活性化関数にスプラインを当てはめることで、
評価ルーチンとしての適用性を実証したい。この目的のために、relu、elu、tanh、sigmoidを検討し、導出性制約のない線形スプラインを使用する。
また、ターゲット関数をできるだけ忠実に模倣したいので、粗さのペナルティは適用しない。ノットの選択に関しては、区間(-1, 1)上で20の等間隔のブレークポイントを選択した。


2.1 Implementation

セクション1.1で説明した切り捨て基底関数による定式化は概念的には単純であるが、その数値的・計算的特性はあまり魅力的なものではない。
このため、実際にはBスプラインのパラメトリック化[8]を採用します。
これにより、スパース性が一定で、各ローカル区間でフィットする多項式の次数に依存するブロックデザイン行列を生成することができます。
一連のノットξ1, ξ2, - - , ξKが与えられたとき、導出可能性の制約なしに、各区間[ξk, ξk+1]k=1,---,K-1に直線をフィッティングします。行列形式では

式（６)

ここでy?kはξkとξk+1における活性化関数の評価を含み、βksはスプライン係数、S(2K)×(2K)はk番目の区間における基底展開を表す各ブロックSkを持つブロック対角行列である。
式(6)の連立方程式を解くには、HHLを使って行列Sを反転させる必要があります。
それでも、ブロック対角行列の逆行列はブロック対角行列のままであり、各ブロックに対応する逆行列があるという事実を利用することができます。
このことは、関数全体に対して1つの量子線形システムSk ｜βki = ｜y?kiを解く代わりに、K個の2×2量子線形システムSk ｜βki = ｜y?kiを解くことができることを意味する。
この小さなトリックにより、利用可能な量子シミュレータの実用的な制限を克服することができ、量子シミュレーションによるスプライン係数の計算が可能になります。

特に、完全なQSplineの計算は3つのステップで実行される。まず、HHLはk番目の区間のスプライン係数を計算する：

式（７)

第二に、｜βki｜はk番目の区間の入力を符号化した量子状態と量子干渉を介して相互作用する。βkiと｜xi,ki｜のスカラー積はスワップテスト[9]を用いて計算される：

式（８)

このとき、量子状態の振幅｜fi,ki｜はxi,kで評価される活性化関数の推定値を埋め込む。
第三に、｜fi,ki｜は状態｜0i｜の確率を得るために測定される。これは次のようにβkとxi,kの間のドット積に依存する：

式（９)、式（１０)

最後に、xi,kに対応する活性化関数推定値を、式(10)を逆変換して fi,kを得る。
推定値は量子状態の振幅として符号化されるため、本質的に区間[0, 1]に拘束されることに注意してください。
このため、まず対象となる活性化関数をスケーリングします（すなわち、fi,k → f ? i,k ⊆ [0, 1]）。
次にQSplineをf ? i,kに対して学習させ、その結果を逆変換して元のfi,kを得ます。


3 Result

The results of hybrid QSpline are illustrated in Fig. 1.

量子スプラインは活性化曲線を非常によく再現する。
シグモイドと双曲線タンジェントでは、推定区間の境界でわずかなずれはあるものの、ほぼ完全に一致する。
ReluとEluの場合も同様であるが、x領域の負の部分に若干の系統的誤差が生じているようである。
可能な説明は、量子アルゴリズムの忠実度を表す青い点を見ることによって行うことができます。
実際、忠実度が低い領域でより大きな偏差が現れており、HHLの実装が我々の設定でうまく動作していない可能性を示唆しています。
次に、完全量子回路を利用した活性化曲線のサブセットを用いて、さらなる試みが行われました。その結果を図2に示す。
この場合、適合度は明らかに悪化し、目標曲線がほぼ系統的に過大評価されました。
これは、推定回路に加えて2つ目の評価回路を採用したためと考えられる。
したがって、2つの測定フェーズを持つことで、より多くの不確かさが導入され、それが伝播してより大きな誤差が生じる。
とはいえ、QSplineも同様に、曲線の非線形挙動を再現できることに注目してほしい。このため、さらにチューニングが必要ではあるが、この結果は有望であると考えられる。
 両戦略の適合度の定量的評価を表1に報告する。
 
 
 参照量子技術はHHLアルゴリズムである。
 HHLは、xを線形システムAx = bの解とし、Aをエルミートデザイン行列とし、bを｜bi｜の振幅で符号化した｜xi｜の形の量子重ね合わせを近似的に作成する方法である。
 計算の観点からは、これはおおよそO(s 2κ 2 log(n)／)のように成長する時間を必要とする(HHLと古典的な対応との比較については表2を参照)。
 このアルゴリズムは行列のサイズに対して対数的にスケールするため、古典的な代替案と比較すると指数関数的な利点がある。
 しかし、その複雑さはsとκの多項式であり、HHLの計算上の利点を破壊しないように、条件数とスパース性に制約を導入しなければならない。
 つまり、HHLの計算上の優位性を崩さないためには、条件数とスパース性に制約を導入しなければなりません。
 
 
 (途中)
 